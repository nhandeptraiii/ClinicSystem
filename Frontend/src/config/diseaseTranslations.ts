export type DiseaseInfo = {
  code: string;
  nameEn: string;
  nameVi: string;
  severity?: 'low' | 'medium' | 'high';
  noteVi?: string;
};

const toTitleCase = (text: string) =>
  text.replace(/\w\S*/g, (word) => word.charAt(0).toUpperCase() + word.slice(1));

const diseaseCodes: string[] = [
  'acute bronchiolitis',
  'acute bronchitis',
  'acute bronchospasm',
  'acute otitis media',
  'acute pancreatitis',
  'acute sinusitis',
  'adhesive capsulitis of the shoulder',
  'allergy',
  'ankylosing spondylitis',
  'anxiety',
  'aphthous ulcer',
  'appendicitis',
  'arthritis of the hip',
  'ascending cholangitis',
  'asthma',
  'atrial flutter',
  'atrophic vaginitis',
  'autism',
  'balanitis',
  'benign vaginal discharge (leukorrhea)',
  'blepharitis',
  'brachial neuritis',
  'breast infection (mastitis)',
  'bursitis',
  'cellulitis or abscess of mouth',
  'cervicitis',
  'cholecystitis',
  'chorioretinitis',
  'chronic back pain',
  'chronic constipation',
  'chronic knee pain',
  'chronic otitis media',
  'chronic pain disorder',
  'chronic pancreatitis',
  'chronic rheumatic fever',
  'chronic sinusitis',
  'cold sore',
  'common cold',
  'complex regional pain syndrome',
  'conjunctivitis',
  'conjunctivitis due to allergy',
  'conjunctivitis due to bacteria',
  'conjunctivitis due to virus',
  'contact dermatitis',
  'cornea infection',
  'cystitis',
  'dermatitis due to sun exposure',
  'diaper rash',
  'diverticulitis',
  'ectopic pregnancy',
  'eczema',
  'encephalitis',
  'endocarditis',
  'endophthalmitis',
  'epididymitis',
  'esophagitis',
  'female genitalia infection',
  'flu',
  'fluid overload',
  'food allergy',
  'foreign body in the gastrointestinal tract',
  'fungal infection of the hair',
  'fungal infection of the skin',
  'gastritis',
  'gastroduodenal ulcer',
  'gastroesophageal reflux disease (gerd)',
  'gastrointestinal hemorrhage',
  'gastroparesis',
  'headache after lumbar puncture',
  'hidradenitis suppurativa',
  'hypertension of pregnancy',
  'idiopathic painful menstruation',
  'infectious gastroenteritis',
  'iridocyclitis',
  'irritable bowel syndrome',
  'labyrinthitis',
  'laryngitis',
  'lateral epicondylitis (tennis elbow)',
  'lymphadenitis',
  'male genitalia infection',
  'mastoiditis',
  'meningitis',
  'migraine',
  'mononeuritis',
  'mucositis',
  'myositis',
  'noninfectious gastroenteritis',
  'oral thrush (yeast infection)',
  'orbital cellulitis',
  'osteoarthritis',
  'osteomyelitis',
  'otitis externa (swimmer\'s ear)',
  'otitis media',
  'ovarian cyst',
  'ovarian torsion',
  'pain after an operation',
  'pain disorder affecting the neck',
  'pericarditis',
  'perirectal infection',
  'peritonitis',
  'pinworm infection',
  'plantar fasciitis',
  'pneumonia',
  'polycystic ovarian syndrome (pcos)',
  'postoperative infection',
  'primary insomnia',
  'problem during pregnancy',
  'prostatitis',
  'psoriasis',
  'pyelonephritis',
  'pyogenic skin infection',
  'rheumatoid arthritis',
  'scarlet fever',
  'scleritis',
  'seasonal allergies (hay fever)',
  'seborrheic dermatitis',
  'sialoadenitis',
  'sick sinus syndrome',
  'sinus bradycardia',
  'spondylitis',
  'tendinitis',
  'tension headache',
  'threatened pregnancy',
  'thrombophlebitis',
  'tonsillitis',
  'tracheitis',
  'trichomonas infection',
  'ulcerative colitis',
  'urethritis',
  'urinary tract infection',
  'vaginal cyst',
  'vaginal yeast infection',
  'vaginismus',
  'vaginitis',
  'vasculitis',
  'yeast infection',
];

const viOverrides: Partial<Record<string, Partial<DiseaseInfo>>> = {
  'acute bronchiolitis': { nameVi: 'Viêm tiểu phế quản cấp', severity: 'high', noteVi: 'Thường gặp ở trẻ nhỏ, cần theo dõi khó thở.' },
  'acute bronchitis': { nameVi: 'Viêm phế quản cấp', severity: 'medium' },
  'acute bronchospasm': { nameVi: 'Co thắt phế quản cấp', severity: 'high', noteVi: 'Nếu khó thở tăng dần, cần hỗ trợ y tế sớm.' },
  'acute otitis media': { nameVi: 'Viêm tai giữa cấp', severity: 'medium' },
  'acute pancreatitis': { nameVi: 'Viêm tụy cấp', severity: 'high', noteVi: 'Đau bụng dữ dội, có thể nguy hiểm, nên khám ngay.' },
  'acute sinusitis': { nameVi: 'Viêm xoang cấp', severity: 'medium' },
  'adhesive capsulitis of the shoulder': { nameVi: 'Viêm dính bao khớp vai (đông cứng vai)', severity: 'medium' },
  allergy: { nameVi: 'Dị ứng', severity: 'low' },
  'ankylosing spondylitis': { nameVi: 'Viêm cột sống dính khớp', severity: 'medium' },
  anxiety: { nameVi: 'Rối loạn lo âu', severity: 'medium' },
  'aphthous ulcer': { nameVi: 'Loét áp tơ', severity: 'low' },
  appendicitis: { nameVi: 'Viêm ruột thừa', severity: 'high', noteVi: 'Đau bụng phải tăng dần, cần khám cấp cứu.' },
  'arthritis of the hip': { nameVi: 'Viêm/thoái hóa khớp háng', severity: 'medium' },
  'ascending cholangitis': { nameVi: 'Viêm đường mật ngược dòng', severity: 'high', noteVi: 'Sốt, vàng da, đau bụng – cần điều trị sớm.' },
  asthma: { nameVi: 'Hen phế quản', severity: 'medium' },
  'atrial flutter': { nameVi: 'Cuồng nhĩ', severity: 'high', noteVi: 'Rối loạn nhịp, nên khám tim mạch sớm.' },
  'atrophic vaginitis': { nameVi: 'Viêm teo âm đạo', severity: 'medium' },
  autism: { nameVi: 'Rối loạn phổ tự kỷ', severity: 'medium' },
  balanitis: { nameVi: 'Viêm quy đầu', severity: 'medium' },
  'benign vaginal discharge (leukorrhea)': { nameVi: 'Khí hư sinh lý', severity: 'low' },
  blepharitis: { nameVi: 'Viêm bờ mi', severity: 'low' },
  'brachial neuritis': { nameVi: 'Viêm dây thần kinh cánh tay', severity: 'medium' },
  'breast infection (mastitis)': { nameVi: 'Viêm tuyến vú', severity: 'medium' },
  bursitis: { nameVi: 'Viêm bao hoạt dịch', severity: 'medium' },
  'cellulitis or abscess of mouth': { nameVi: 'Viêm/áp xe miệng', severity: 'medium' },
  cervicitis: { nameVi: 'Viêm cổ tử cung', severity: 'medium' },
  cholecystitis: { nameVi: 'Viêm túi mật', severity: 'high' },
  chorioretinitis: { nameVi: 'Viêm màng mạch - võng mạc', severity: 'high' },
  'chronic back pain': { nameVi: 'Đau lưng mạn tính', severity: 'medium' },
  'chronic constipation': { nameVi: 'Táo bón mạn', severity: 'low' },
  'chronic knee pain': { nameVi: 'Đau gối mạn', severity: 'medium' },
  'chronic otitis media': { nameVi: 'Viêm tai giữa mạn', severity: 'medium' },
  'chronic pain disorder': { nameVi: 'Rối loạn đau mạn tính', severity: 'medium' },
  'chronic pancreatitis': { nameVi: 'Viêm tụy mạn', severity: 'high' },
  'chronic rheumatic fever': { nameVi: 'Thấp tim mạn', severity: 'high' },
  'chronic sinusitis': { nameVi: 'Viêm xoang mạn', severity: 'medium' },
  'cold sore': { nameVi: 'Mụn rộp môi', severity: 'low' },
  'common cold': { nameVi: 'Cảm lạnh', severity: 'low' },
  'complex regional pain syndrome': { nameVi: 'Hội chứng đau vùng phức tạp', severity: 'medium' },
  conjunctivitis: { nameVi: 'Viêm kết mạc', severity: 'low' },
  'conjunctivitis due to allergy': { nameVi: 'Viêm kết mạc dị ứng', severity: 'low' },
  'conjunctivitis due to bacteria': { nameVi: 'Viêm kết mạc do vi khuẩn', severity: 'medium' },
  'conjunctivitis due to virus': { nameVi: 'Viêm kết mạc do virus', severity: 'medium' },
  'contact dermatitis': { nameVi: 'Viêm da tiếp xúc', severity: 'low' },
  'cornea infection': { nameVi: 'Nhiễm trùng giác mạc', severity: 'medium' },
  cystitis: { nameVi: 'Viêm bàng quang', severity: 'medium' },
  'dermatitis due to sun exposure': { nameVi: 'Cháy nắng/viêm da do nắng', severity: 'low' },
  'diaper rash': { nameVi: 'Hăm tã', severity: 'low' },
  diverticulitis: { nameVi: 'Viêm túi thừa đại tràng', severity: 'medium' },
  'ectopic pregnancy': { nameVi: 'Thai ngoài tử cung', severity: 'high', noteVi: 'Tình trạng cấp cứu, cần khám ngay.' },
  eczema: { nameVi: 'Chàm/eczema', severity: 'low' },
  encephalitis: { nameVi: 'Viêm não', severity: 'high', noteVi: 'Có thể nguy hiểm, cần nhập viện đánh giá.' },
  endocarditis: { nameVi: 'Viêm nội tâm mạc', severity: 'high' },
  endophthalmitis: { nameVi: 'Viêm nội nhãn', severity: 'high' },
  epididymitis: { nameVi: 'Viêm mào tinh', severity: 'medium' },
  esophagitis: { nameVi: 'Viêm thực quản', severity: 'medium' },
  'female genitalia infection': { nameVi: 'Nhiễm trùng cơ quan sinh dục nữ', severity: 'medium' },
  flu: { nameVi: 'Cúm', severity: 'medium' },
  'fluid overload': { nameVi: 'Quá tải dịch/ứ nước', severity: 'medium' },
  'food allergy': { nameVi: 'Dị ứng thức ăn', severity: 'medium' },
  'foreign body in the gastrointestinal tract': { nameVi: 'Dị vật đường tiêu hóa', severity: 'medium', noteVi: 'Nếu đau hoặc nôn, cần kiểm tra sớm.' },
  'fungal infection of the hair': { nameVi: 'Nấm da đầu', severity: 'low' },
  'fungal infection of the skin': { nameVi: 'Nấm da', severity: 'low' },
  gastritis: { nameVi: 'Viêm dạ dày', severity: 'medium' },
  'gastroduodenal ulcer': { nameVi: 'Loét dạ dày - tá tràng', severity: 'medium' },
  'gastroesophageal reflux disease (gerd)': { nameVi: 'Trào ngược dạ dày - thực quản (GERD)', severity: 'medium' },
  'gastrointestinal hemorrhage': { nameVi: 'Xuất huyết tiêu hóa', severity: 'high', noteVi: 'Nôn ra máu/đi ngoài phân đen: cần cấp cứu.' },
  gastroparesis: { nameVi: 'Liệt/chậm rỗng dạ dày', severity: 'medium' },
  'headache after lumbar puncture': { nameVi: 'Đau đầu sau chọc dò tủy sống', severity: 'medium' },
  'hidradenitis suppurativa': { nameVi: 'Viêm tuyến mồ hôi mủ', severity: 'medium' },
  'hypertension of pregnancy': { nameVi: 'Tăng huyết áp thai kỳ', severity: 'high', noteVi: 'Cần theo dõi sát huyết áp và khám sản khoa.' },
  'idiopathic painful menstruation': { nameVi: 'Đau bụng kinh nguyên phát', severity: 'low' },
  'infectious gastroenteritis': { nameVi: 'Viêm dạ dày ruột nhiễm trùng', severity: 'medium' },
  iridocyclitis: { nameVi: 'Viêm mống mắt - thể mi', severity: 'medium' },
  'irritable bowel syndrome': { nameVi: 'Hội chứng ruột kích thích', severity: 'medium' },
  labyrinthitis: { nameVi: 'Viêm mê đạo tai', severity: 'medium' },
  laryngitis: { nameVi: 'Viêm thanh quản', severity: 'medium' },
  'lateral epicondylitis (tennis elbow)': { nameVi: 'Viêm lồi cầu ngoài (khuỷu tay tennis)', severity: 'low' },
  lymphadenitis: { nameVi: 'Viêm hạch', severity: 'medium' },
  'male genitalia infection': { nameVi: 'Nhiễm trùng cơ quan sinh dục nam', severity: 'medium' },
  mastoiditis: { nameVi: 'Viêm xương chũm', severity: 'high' },
  meningitis: { nameVi: 'Viêm màng não', severity: 'high', noteVi: 'Đau đầu, sốt, cổ cứng – cần cấp cứu.' },
  migraine: { nameVi: 'Đau nửa đầu', severity: 'medium' },
  mononeuritis: { nameVi: 'Viêm một dây thần kinh', severity: 'medium' },
  mucositis: { nameVi: 'Viêm niêm mạc', severity: 'medium' },
  myositis: { nameVi: 'Viêm cơ', severity: 'medium' },
  'noninfectious gastroenteritis': { nameVi: 'Viêm dạ dày ruột không do nhiễm', severity: 'medium' },
  'oral thrush (yeast infection)': { nameVi: 'Nấm miệng', severity: 'medium' },
  'orbital cellulitis': { nameVi: 'Viêm mô quanh mắt', severity: 'high' },
  osteoarthritis: { nameVi: 'Thoái hóa khớp', severity: 'medium' },
  osteomyelitis: { nameVi: 'Viêm xương tủy', severity: 'high' },
  'otitis externa (swimmer\'s ear)': { nameVi: 'Viêm ống tai ngoài', severity: 'medium' },
  'otitis media': { nameVi: 'Viêm tai giữa', severity: 'medium' },
  'ovarian cyst': { nameVi: 'Nang buồng trứng', severity: 'medium' },
  'ovarian torsion': { nameVi: 'Xoắn buồng trứng', severity: 'high', noteVi: 'Đau bụng đột ngột, cần khám sản phụ khoa ngay.' },
  'pain after an operation': { nameVi: 'Đau sau phẫu thuật', severity: 'medium' },
  'pain disorder affecting the neck': { nameVi: 'Rối loạn đau vùng cổ', severity: 'medium' },
  pericarditis: { nameVi: 'Viêm màng ngoài tim', severity: 'high' },
  'perirectal infection': { nameVi: 'Nhiễm trùng quanh hậu môn', severity: 'medium' },
  peritonitis: { nameVi: 'Viêm phúc mạc', severity: 'high', noteVi: 'Đau bụng lan tỏa, bụng cứng – cần cấp cứu.' },
  'pinworm infection': { nameVi: 'Nhiễm giun kim', severity: 'low' },
  'plantar fasciitis': { nameVi: 'Viêm cân gan bàn chân', severity: 'medium' },
  pneumonia: { nameVi: 'Viêm phổi', severity: 'high', noteVi: 'Sốt, ho, khó thở – nên khám sớm.' },
  'polycystic ovarian syndrome (pcos)': { nameVi: 'Hội chứng buồng trứng đa nang (PCOS)', severity: 'medium' },
  'postoperative infection': { nameVi: 'Nhiễm trùng sau phẫu thuật', severity: 'high' },
  'primary insomnia': { nameVi: 'Mất ngủ nguyên phát', severity: 'low' },
  'problem during pregnancy': { nameVi: 'Vấn đề trong thai kỳ', severity: 'high', noteVi: 'Cần theo dõi và khám sản khoa.' },
  prostatitis: { nameVi: 'Viêm tiền liệt tuyến', severity: 'medium' },
  psoriasis: { nameVi: 'Vảy nến', severity: 'medium' },
  pyelonephritis: { nameVi: 'Viêm thận - bể thận', severity: 'high' },
  'pyogenic skin infection': { nameVi: 'Nhiễm trùng da sinh mủ', severity: 'medium' },
  'rheumatoid arthritis': { nameVi: 'Viêm khớp dạng thấp', severity: 'medium' },
  'scarlet fever': { nameVi: 'Sốt đỏ đào', severity: 'medium' },
  scleritis: { nameVi: 'Viêm củng mạc', severity: 'medium' },
  'seasonal allergies (hay fever)': { nameVi: 'Viêm mũi dị ứng (sốt cỏ khô)', severity: 'low' },
  'seborrheic dermatitis': { nameVi: 'Viêm da tiết bã', severity: 'low' },
  sialoadenitis: { nameVi: 'Viêm tuyến nước bọt', severity: 'medium' },
  'sick sinus syndrome': { nameVi: 'Hội chứng nút xoang bệnh', severity: 'medium' },
  'sinus bradycardia': { nameVi: 'Nhịp chậm xoang', severity: 'medium' },
  spondylitis: { nameVi: 'Viêm cột sống', severity: 'medium' },
  tendinitis: { nameVi: 'Viêm gân', severity: 'medium' },
  'tension headache': { nameVi: 'Đau đầu căng thẳng', severity: 'medium' },
  'threatened pregnancy': { nameVi: 'Dọa sảy thai', severity: 'high' },
  thrombophlebitis: { nameVi: 'Viêm tĩnh mạch huyết khối', severity: 'high' },
  tonsillitis: { nameVi: 'Viêm amidan', severity: 'medium' },
  tracheitis: { nameVi: 'Viêm khí quản', severity: 'medium' },
  'trichomonas infection': { nameVi: 'Nhiễm trùng roi Trichomonas', severity: 'medium' },
  'ulcerative colitis': { nameVi: 'Viêm loét đại tràng', severity: 'high' },
  urethritis: { nameVi: 'Viêm niệu đạo', severity: 'medium' },
  'urinary tract infection': { nameVi: 'Nhiễm trùng đường tiểu', severity: 'medium' },
  'vaginal cyst': { nameVi: 'Nang âm đạo', severity: 'medium' },
  'vaginal yeast infection': { nameVi: 'Nhiễm nấm âm đạo', severity: 'medium' },
  vaginismus: { nameVi: 'Co thắt âm đạo', severity: 'medium' },
  vaginitis: { nameVi: 'Viêm âm đạo', severity: 'medium' },
  vasculitis: { nameVi: 'Viêm mạch máu', severity: 'medium' },
  'yeast infection': { nameVi: 'Nhiễm nấm men', severity: 'medium' },
};

const wordMap: Record<string, string> = {
  acute: 'cấp',
  chronic: 'mạn',
  pain: 'đau',
  painful: 'đau',
  disorder: 'rối loạn',
  syndrome: 'hội chứng',
  infection: 'nhiễm trùng',
  infections: 'nhiễm trùng',
  inflammatory: 'viêm',
  allergy: 'dị ứng',
  allergies: 'dị ứng',
  allergic: 'dị ứng',
  ulcer: 'loét',
  abscess: 'áp xe',
  cellulitis: 'viêm mô',
  gastroenteritis: 'viêm dạ dày ruột',
  gastritis: 'viêm dạ dày',
  esophagitis: 'viêm thực quản',
  reflux: 'trào ngược',
  bronchitis: 'viêm phế quản',
  bronchiolitis: 'viêm tiểu phế quản',
  bronchospasm: 'co thắt phế quản',
  otitis: 'viêm tai',
  sinusitis: 'viêm xoang',
  laryngitis: 'viêm thanh quản',
  tracheitis: 'viêm khí quản',
  tonsillitis: 'viêm amidan',
  pneumonia: 'viêm phổi',
  dermatitis: 'viêm da',
  eczema: 'chàm',
  psoriasis: 'vảy nến',
  conjunctivitis: 'viêm kết mạc',
  encephalitis: 'viêm não',
  meningitis: 'viêm màng não',
  pancreatitis: 'viêm tụy',
  colitis: 'đại tràng',
  appendicitis: 'viêm ruột thừa',
  diverticulitis: 'viêm túi thừa',
  cholecystitis: 'viêm túi mật',
  cholangitis: 'viêm đường mật',
  mastitis: 'viêm tuyến vú',
  prostatitis: 'viêm tiền liệt tuyến',
  epididymitis: 'viêm mào tinh',
  balanitis: 'viêm quy đầu',
  vaginitis: 'viêm âm đạo',
  vaginismus: 'co thắt âm đạo',
  cystitis: 'viêm bàng quang',
  pyelonephritis: 'viêm thận - bể thận',
  urethritis: 'viêm niệu đạo',
  vasculitis: 'viêm mạch',
  thrombophlebitis: 'viêm tĩnh mạch huyết khối',
  osteomyelitis: 'viêm xương tủy',
  osteoarthritis: 'thoái hóa khớp',
  arthritis: 'viêm khớp',
  bursitis: 'viêm bao hoạt dịch',
  tendinitis: 'viêm gân',
  spondylitis: 'viêm cột sống',
  neuritis: 'viêm dây thần kinh',
  myositis: 'viêm cơ',
  mucositis: 'viêm niêm mạc',
  iritis: 'viêm mống mắt',
  scleritis: 'viêm củng mạc',
  iridocyclitis: 'viêm mống mắt - thể mi',
  chorioretinitis: 'viêm màng mạch - võng mạc',
  otitismedia: 'viêm tai giữa',
  orbital: 'ổ mắt',
  conjunctivitisdue: 'viêm kết mạc',
  neuropathy: 'bệnh dây thần kinh',
  gastroesophageal: 'dạ dày - thực quản',
  ulcerative: 'viêm loét',
};

const pickSeverity = (code: string): DiseaseInfo['severity'] => {
  const normalized = code.toLowerCase();
  if (
    /peritonitis|appendicitis|pneumonia|meningitis|encephalitis|pancreatitis|ascending cholangitis|gastrointestinal hemorrhage|pericarditis|endocarditis|ectopic pregnancy|ovarian torsion|pyelonephritis|thrombophlebitis|mastoiditis|hidradenitis/.test(
      normalized
    )
  ) {
    return 'high';
  }
  if (
    /acute|infection|abscess|cellulitis|vasculitis|postoperative|problem during pregnancy|threatened pregnancy|hydradenitis|hypertension of pregnancy|fluid overload/.test(
      normalized
    )
  ) {
    return 'medium';
  }
  return 'low';
};

const buildNameVi = (code: string) => {
  const normalized = code.toLowerCase();
  const overrideName = viOverrides[normalized]?.nameVi;
  if (overrideName) {
    return overrideName;
  }

  const tokens = normalized.replace(/[()]/g, '').split(/\s+/);
  const translated = tokens
    .map((token) => {
      const mapped = wordMap[token];
      if (mapped) {
        return mapped;
      }
      return token;
    })
    .join(' ')
    .replace(/\s+/g, ' ')
    .trim();

  const fallback = translated === normalized ? toTitleCase(code) : toTitleCase(translated);
  return fallback;
};

export const diseaseDictionary: Record<string, DiseaseInfo> = diseaseCodes.reduce<Record<string, DiseaseInfo>>(
  (acc, code) => {
    const normalized = code.toLowerCase();
    const override = viOverrides[normalized];
    acc[code] = {
      code,
      nameEn: toTitleCase(code),
      nameVi: buildNameVi(code),
      severity: override?.severity ?? pickSeverity(code),
      noteVi: override?.noteVi,
    };
    return acc;
  },
  {}
);
